<h2 class="text-center">Start Testing</h2>

<div class="container">
  <!-- Module dropdown -->
  <div class="form-group">
    <label>Select Module</label>
    <select [ngModel]="selectedModule()" (ngModelChange)="onModuleChange($event)">
      <option value="">-- Choose Module --</option>
      <option *ngFor="let m of modules" [value]="m.id">{{ m.name }}</option>
    </select>
  </div>

  <!-- Filters -->
  <div class="filters" *ngIf="filteredTestCases().length > 0">
    <input type="text" placeholder="Filter by Sl No" [(ngModel)]="filter.slNo" />
    <input type="text" placeholder="Filter by TestCase ID" [(ngModel)]="filter.testCaseId" />
    <input type="text" placeholder="Filter by Use Case" [(ngModel)]="filter.useCase" />
    <select [(ngModel)]="filter.result">
      <option value="">All Results</option>
      <option value="Pass">Pass</option>
      <option value="Fail">Fail</option>
      <option value="Pending">Pending</option>
    </select>
  </div>

  <!-- Test-case table -->
  <div *ngIf="filteredAndSearchedTestCases().length > 0">
    <table>
      <thead>
        <tr>
          <th>Sl No</th>
          <th>Version</th>
          <th>Use Case</th>
          <th>Test Case ID</th>
          <th>Scenario</th>
          <th>Steps</th>
          <th>Expected</th>
          <th>Result</th>
          <th>Actual</th>
          <th>Remarks</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let tc of filteredAndSearchedTestCases(); let i = index" [formGroup]="formGroups()[i]">
          <td>{{ tc.slNo }}</td>
          <td>{{ tc.version }}</td>
          <td class="wrap-text">{{ tc.fixed.useCase }}</td>
          <td>{{ tc.fixed.testCaseId }}</td>
          <td class="wrap-text">{{ tc.fixed.scenario }}</td>
          <td class="wrap-text">{{ tc.fixed.steps }}</td>
          <td class="wrap-text">{{ tc.fixed.expected }}</td>
          <td>
            <select formControlName="result">
              <option value="Pass">Pass ✅</option>
              <option value="Fail">Fail ❌</option>
              <option value="Pending">Pending ⏳</option>
            </select>
          </td>
          <td><input type="text" formControlName="actual" /></td>
          <td><input type="text" formControlName="remarks" /></td>
        </tr>
      </tbody>
    </table>

    <button class="btn-save" (click)="onSave()">✅ Save Results</button>
  </div>
</div>
